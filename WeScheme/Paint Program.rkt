(define-struct a(m c s x y))
(define(d p)(put-image(circle(a-s p)'solid(cond[(=(a-c p)1)'black][(=(a-c p)2)'red][(=(a-c p)3)'yellow][(=(a-c p)4)'green][(=(a-c p)5)'cyan][(=(a-c p)6)'blue][(=(a-c p)7)'magenta][(=(a-c p)8)'white]))(a-x p)(- 500(a-y p))(above(rectangle 640 20'solid(cond[(=(a-c p)1)'black][(=(a-c p)2)'red][(=(a-c p)3)'yellow][(=(a-c p)4)'green][(=(a-c p)5)'cyan][(=(a-c p)6)'blue][(=(a-c p)7)'magenta][(=(a-c p)8)'white]))(a-m p))))
(define(p m x y o)(make-a(put-image(cond[(and(or(string=?"button-down"o)(string=?"drag"o))(=(a-c m)1))(circle(a-s m)'solid'black)][(and(or(string=?"button-down"o)(string=?"drag"o))(=(a-c m)2))(circle(a-s m)'solid'red)][(and(or(string=?"button-down"o)(string=?"drag"o))(=(a-c m)3))(circle(a-s m)'solid'yellow)][(and(or(string=?"button-down"o)(string=?"drag"o))(=(a-c m)4))(circle(a-s m)'solid'green)][(and(or(string=?"button-down"o)(string=?"drag"o))(=(a-c m)5))(circle(a-s m)'solid'cyan)][(and(or(string=?"button-down"o)(string=?"drag"o))(=(a-c m)6))(circle(a-s m)'solid'blue)][(and(or(string=?"button-down"o)(string=?"drag"o))(=(a-c m)7))(circle(a-s m)'solid'magenta)][(and(or(string=?"button-down"o)(string=?"drag"o))(=(a-c m)8))(circle(a-s m)'solid'white)][else(circle 0 0'red)])x(- 500 y)(a-m m))(a-c m)(a-s m)x y))
(define(k m s)(cond[(string=?"\b"s)(make-a(rectangle 640 480'solid'white)(a-c m)(a-s m)(a-x m)(a-y m))][(string=?"1"s)(make-a(a-m m)1(a-s m)(a-x m)(a-y m))][(string=?"2"s)(make-a(a-m m)2(a-s m)(a-x m)(a-y m))][(string=?"3"s)(make-a(a-m m)3(a-s m)(a-x m)(a-y m))][(string=?"4"s)(make-a(a-m m)4(a-s m)(a-x m)(a-y m))][(string=?"5"s)(make-a(a-m m)5(a-s m)(a-x m)(a-y m))][(string=?"6"s)(make-a(a-m m)6(a-s m)(a-x m)(a-y m))][(string=?"7"s)(make-a(a-m m)7(a-s m)(a-x m)(a-y m))][(string=?"8"s)(make-a(a-m m)8(a-s m)(a-x m)(a-y m))][(or(string=?"up"s)(string=?"w"s))(make-a(a-m m)(a-c m)(+(a-s m)1)(a-x m)(a-y m))][(or(string=?"down"s)(string=?"s"s))(make-a(a-m m)(a-c m)(if(=(a-s m)1)1(-(a-s m)1))(a-x m)(a-y m))][(string=?"home"s)(make-a(a-m m)(a-c m)10(a-x m)(a-y m))][else(make-a(a-m m)(a-c m)(a-s m)(a-x m)(a-y m))]))
(big-bang(make-a(rectangle 640 480'solid'white)1 10 0 0)(on-key k)(on-mouse p)(to-draw d))
